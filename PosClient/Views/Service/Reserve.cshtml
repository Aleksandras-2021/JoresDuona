@model PosShared.ViewModels.ReservationViewModel

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger">
        @TempData["Error"]
    </div>
}

<div class="container mt-4">
    <h2>Make a Reservation</h2>
    
    <form asp-controller="Reservation" asp-action="Reserve" method="post">
        <input asp-for="ServiceId" class="form-control" required hidden />
            
        <div class="form-group mb-3">
            <label asp-for="CustomerName" class="form-label">Customer Name</label>
            <input asp-for="CustomerName" class="form-control" required />
            <span asp-validation-for="CustomerName" class="text-danger"></span>
        </div>

        <div class="form-group mb-3">
            <label asp-for="ReservationTime" class="form-label">Select Date and Time</label>
            <input asp-for="ReservationTime" type="datetime-local"  class="form-control" required />
            <span asp-validation-for="ReservationTime" class="text-danger"></span>
        </div>


        <div class="form-group mb-3">
            <label asp-for="CustomerPhone" class="form-label">Phone Number</label>
            <input asp-for="CustomerPhone" class="form-control" required />
            <span asp-validation-for="CustomerPhone" class="text-danger"></span>
        </div>

        <div class="form-group">
            <button type="submit" class="btn btn-primary">Submit Reservation</button>
            <a asp-controller="Service" asp-action="Index" class="btn btn-secondary">Back to Services</a>
        </div>
    </form>
    
    
       <table class="table table-striped">
                <thead>
                <tr>
                    <th>Service</th>
                    <th>Customer Name</th>
                    <th>Phone</th>
                    <th>Date & Time</th>
                    <th>End</th>
                    <th>Client name & phone</th>
                </tr>
                </thead>
                <tbody>
                @foreach (var reservation in Model.Reservations.Items)
                {
                    <tr>
                        <td>@reservation.ServiceId</td>
                        <td>@reservation.CustomerName</td>
                        <td>@reservation.CustomerPhone</td>
                        <td>@reservation.ReservationTime.ToLocalTime().ToString("dd/MM/yyyy HH:mm")</td>
                        <td>@reservation.ReservationEndTime.ToLocalTime().ToString("dd/MM/yyyy HH:mm")</td>
                        <td>@($"({reservation.CustomerName}, {reservation.CustomerPhone})")</td>
                        <td>@reservation.Status</td>
                    </tr>
                }
                </tbody>
                <!-- Pagination -->
                <nav aria-label="Order pagination">
                    <ul class="pagination justify-content-center">
                        @if (Model.Reservations.HasPreviousPage)
                        {
                            <li class="page-item">
                                <a class="page-link" href="?pageNumber=@(Model.Reservations.PageNumber - 1)&pageSize=@Model.Reservations.PageSize" aria-label="Previous">
                                    <span aria-hidden="true">&laquo;</span>
                                </a>
                            </li>
                        }
                
                        @for (int i = 1; i <= Model.Reservations.TotalPages; i++)
                        {
                            <li class="page-item @(i == Model.Reservations.PageNumber ? "active" : "")">
                                <a class="page-link" href="?pageNumber=@i&pageSize=@Model.Reservations.PageSize">@i</a>
                            </li>
                        }
                
                        @if (Model.Reservations.HasNextPage)
                        {
                            <li class="page-item">
                                <a class="page-link" href="?pageNumber=@(Model.Reservations.PageNumber + 1)&pageSize=@Model.Reservations.PageSize" aria-label="Next">
                                    <span aria-hidden="true">&raquo;</span>
                                </a>
                            </li>
                        }
                    </ul>
                </nav>
            </table>
</div>